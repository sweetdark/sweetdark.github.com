
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Mario's Blog</title>
  <meta name="author" content="Mario">

  
  <meta name="description" content="一、渲染内存
在所有的agg控制台的例子中都使用了 p256的格式，即RGB格式，即每个字节存储一个颜色值，如下图所示的RGB_buffer的内存工作区。 二、源代码
rendering_buffer.h
文件中 rendering_buffer有两种实现方式。
可以根据你的实际需要，去选择。 1 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://sweetdark.github.com/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Mario's Blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Mario's Blog</a></h1>
  
    <h2>学而不思则罔，思而不学则殆。吾尝终日而思矣，不如须臾之所学也！</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:sweetdark.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">首页</a></li>
  <li><a href="/blog/archives">目录</a></li>
  <li><a href="/about">关于我</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      


  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/04/28/agg/">Agg渲染内存</a></h1>
    
    
    <p class="meta">
      








  


<time datetime="2013-04-28T07:32:00+08:00" pubdate data-updated="true">Apr 28<span>th</span>, 2013</time>
	  

<span class="tags">
  Tag:
  
    <a href='/blog/tags/agg/'>agg</a>
  
</span>

      <span class="share-to-weibo">
        <a href="javascript:void(0)" onclick="window.open('http://service.weibo.com/share/share.php?appkey=&amp;ralateUid=1954936591&amp;title=Agg渲染内存 - &amp;url=http://sweetdark.github.com/blog/2013/04/28/agg/', null, 'width=615,height=505,toolbar=0,status=0')" class="sina-weibo" title="分享到新浪微博"></a>

        <a href="javascript:void(0)" onclick="window.open('http://share.v.t.qq.com/index.php?c=share&amp;a=index&amp;appkey=&amp;title=Agg渲染内存 - &amp;url=http://sweetdark.github.com/blog/2013/04/28/agg/', null, 'width=700,height=680,toolbar=0,status=0')" class="tencent-weibo" title="分享到腾讯微博"></a>

        <a href="javascript:void(0)" onclick="window.open('https://twitter.com/intent/tweet?text=Agg渲染内存 - http://sweetdark.github.com/blog/2013/04/28/agg/', null, 'width=600,height=300,toolbar=0,status=0')" class="twitter" title="分享到Twitter"></a>
      </span>
    </p>
  
  </header>


  <div class="entry-content"><p>一、渲染内存
在所有的agg控制台的例子中都使用了 p256的格式，即RGB格式，即每个字节存储一个颜色值，如下图所示的RGB_buffer的内存工作区。
<img src="http://i.imgur.com/nNA1NsK.png"></p>

<p>二、源代码
rendering_buffer.h
文件中 rendering_buffer有两种实现方式。
可以根据你的实际需要，去选择。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="cp">#ifdef AGG_RENDERING_BUFFER</span>
</span><span class='line'>    <span class="k">typedef</span> <span class="n">AGG_RENDERING_BUFFER</span> <span class="n">rendering_buffer</span><span class="p">;</span>
</span><span class='line'><span class="cp">#else</span>
</span><span class='line'><span class="c1">//  typedef row_ptr_cache&lt;int8u&gt; rendering_buffer;</span>
</span><span class='line'>    <span class="k">typedef</span> <span class="n">row_accessor</span><span class="o">&lt;</span><span class="n">int8u</span><span class="o">&gt;</span> <span class="n">rendering_buffer</span><span class="p">;</span>
</span><span class='line'><span class="cp">#endif</span>
</span></code></pre></td></tr></table></div></figure>


<p>提供的接口很简单都是直接访问内存的操作</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="c1">//-------------------------------------------------------------------</span>
</span><span class='line'><span class="n">row_accessor</span><span class="p">()</span> <span class="o">:</span>
</span><span class='line'>  <span class="n">m_buf</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
</span><span class='line'>  <span class="n">m_start</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
</span><span class='line'>  <span class="n">m_width</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
</span><span class='line'>  <span class="n">m_height</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
</span><span class='line'>  <span class="n">m_stride</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//-------------------------------------------------------------------- 初始化 </span>
</span><span class='line'><span class="n">row_accessor</span><span class="p">(</span><span class="n">T</span><span class="o">*</span> <span class="n">buf</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">width</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">height</span><span class="p">,</span> <span class="kt">int</span> <span class="n">stride</span><span class="p">)</span> <span class="o">:</span>
</span><span class='line'>  <span class="n">m_buf</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
</span><span class='line'>  <span class="n">m_start</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
</span><span class='line'>  <span class="n">m_width</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
</span><span class='line'>  <span class="n">m_height</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
</span><span class='line'>  <span class="n">m_stride</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="n">attach</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">stride</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">//--------------------------------------------------------------------</span>
</span><span class='line'><span class="kt">void</span> <span class="n">attach</span><span class="p">(</span><span class="n">T</span><span class="o">*</span> <span class="n">buf</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">width</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">height</span><span class="p">,</span> <span class="kt">int</span> <span class="n">stride</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>     <span class="n">m_buf</span> <span class="o">=</span> <span class="n">m_start</span> <span class="o">=</span> <span class="n">buf</span><span class="p">;</span>
</span><span class='line'>     <span class="n">m_width</span> <span class="o">=</span> <span class="n">width</span><span class="p">;</span>
</span><span class='line'>     <span class="n">m_height</span> <span class="o">=</span> <span class="n">height</span><span class="p">;</span>
</span><span class='line'>     <span class="n">m_stride</span> <span class="o">=</span> <span class="n">stride</span><span class="p">;</span>
</span><span class='line'>     <span class="k">if</span><span class="p">(</span><span class="n">stride</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>          <span class="n">m_start</span> <span class="o">=</span> <span class="n">m_buf</span> <span class="o">-</span> <span class="kt">int</span><span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">stride</span><span class="p">;</span>
</span><span class='line'>     <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//--------------------------------------------------------------------</span>
</span><span class='line'><span class="n">AGG_INLINE</span>       <span class="n">T</span><span class="o">*</span> <span class="n">buf</span><span class="p">()</span>          <span class="p">{</span> <span class="k">return</span> <span class="n">m_buf</span><span class="p">;</span>    <span class="p">}</span>
</span><span class='line'><span class="n">AGG_INLINE</span> <span class="k">const</span> <span class="n">T</span><span class="o">*</span> <span class="n">buf</span><span class="p">()</span>    <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_buf</span><span class="p">;</span>    <span class="p">}</span>
</span><span class='line'><span class="n">AGG_INLINE</span> <span class="kt">unsigned</span> <span class="n">width</span><span class="p">()</span>  <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_width</span><span class="p">;</span>  <span class="p">}</span>
</span><span class='line'><span class="n">AGG_INLINE</span> <span class="kt">unsigned</span> <span class="n">height</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_height</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'><span class="n">AGG_INLINE</span> <span class="kt">int</span>      <span class="n">stride</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_stride</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'><span class="n">AGG_INLINE</span> <span class="kt">unsigned</span> <span class="n">stride_abs</span><span class="p">()</span> <span class="k">const</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="p">(</span><span class="n">m_stride</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">?</span> <span class="kt">unsigned</span><span class="p">(</span><span class="o">-</span><span class="n">m_stride</span><span class="p">)</span> <span class="o">:</span> <span class="kt">unsigned</span><span class="p">(</span><span class="n">m_stride</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//--------------------------------------------------------------------</span>
</span><span class='line'>  <span class="n">AGG_INLINE</span>       <span class="n">T</span><span class="o">*</span> <span class="n">row_ptr</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">unsigned</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">m_start</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">m_stride</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>  <span class="n">AGG_INLINE</span>       <span class="n">T</span><span class="o">*</span> <span class="n">row_ptr</span><span class="p">(</span><span class="kt">int</span> <span class="n">y</span><span class="p">)</span>       <span class="p">{</span> <span class="k">return</span> <span class="n">m_start</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">m_stride</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">AGG_INLINE</span> <span class="k">const</span> <span class="n">T</span><span class="o">*</span> <span class="n">row_ptr</span><span class="p">(</span><span class="kt">int</span> <span class="n">y</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_start</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">m_stride</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">AGG_INLINE</span> <span class="n">row_data</span> <span class="n">row</span>    <span class="p">(</span><span class="kt">int</span> <span class="n">y</span><span class="p">)</span> <span class="k">const</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">row_data</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">m_width</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">row_ptr</span><span class="p">(</span><span class="n">y</span><span class="p">));</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//--------------------------------------------------------------------</span>
</span><span class='line'><span class="n">template</span><span class="o">&lt;</span><span class="n">class</span> <span class="n">RenBuf</span><span class="o">&gt;</span>
</span><span class='line'><span class="kt">void</span> <span class="n">copy_from</span><span class="p">(</span><span class="k">const</span> <span class="n">RenBuf</span><span class="o">&amp;</span> <span class="n">src</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="kt">unsigned</span> <span class="n">h</span> <span class="o">=</span> <span class="n">height</span><span class="p">();</span>
</span><span class='line'>  <span class="k">if</span><span class="p">(</span><span class="n">src</span><span class="p">.</span><span class="n">height</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">h</span><span class="p">)</span> <span class="n">h</span> <span class="o">=</span> <span class="n">src</span><span class="p">.</span><span class="n">height</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>  <span class="kt">unsigned</span> <span class="n">l</span> <span class="o">=</span> <span class="n">stride_abs</span><span class="p">();</span>
</span><span class='line'>  <span class="k">if</span><span class="p">(</span><span class="n">src</span><span class="p">.</span><span class="n">stride_abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">l</span><span class="p">)</span> <span class="n">l</span> <span class="o">=</span> <span class="n">src</span><span class="p">.</span><span class="n">stride_abs</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">l</span> <span class="o">*=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="kt">unsigned</span> <span class="n">y</span><span class="p">;</span>
</span><span class='line'>  <span class="kt">unsigned</span> <span class="n">w</span> <span class="o">=</span> <span class="n">width</span><span class="p">();</span>
</span><span class='line'>  <span class="k">for</span> <span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">h</span><span class="p">;</span> <span class="n">y</span><span class="o">++</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="n">memcpy</span><span class="p">(</span><span class="n">row_ptr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">),</span> <span class="n">src</span><span class="p">.</span><span class="n">row_ptr</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">l</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//------------------------------用某个颜色值填充内存</span>
</span><span class='line'><span class="kt">void</span> <span class="n">clear</span><span class="p">(</span><span class="n">T</span> <span class="n">value</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="kt">unsigned</span> <span class="n">y</span><span class="p">;</span>
</span><span class='line'>  <span class="kt">unsigned</span> <span class="n">w</span> <span class="o">=</span> <span class="n">width</span><span class="p">();</span>
</span><span class='line'>  <span class="kt">unsigned</span> <span class="n">stride</span> <span class="o">=</span> <span class="n">stride_abs</span><span class="p">();</span>
</span><span class='line'>  <span class="k">for</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">height</span><span class="p">();</span> <span class="n">y</span><span class="o">++</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="n">T</span><span class="o">*</span> <span class="n">p</span> <span class="o">=</span> <span class="n">row_ptr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">);</span>
</span><span class='line'>      <span class="kt">unsigned</span> <span class="n">x</span><span class="p">;</span>
</span><span class='line'>      <span class="k">for</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">stride</span><span class="p">;</span> <span class="n">x</span><span class="o">++</span><span class="p">)</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>          <span class="o">*</span><span class="n">p</span><span class="o">++</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>三、例子</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="cp">#include &lt;stdlib.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;stdio.h&gt;</span>
</span><span class='line'><span class="cp">#include &quot;agg_renderer_base.h&quot;</span>
</span><span class='line'><span class="cp">#include &quot;agg_pixfmt_rgb.h&quot;</span>
</span><span class='line'><span class="cp">#include &quot;agg_rendering_buffer.h&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">enum</span><span class="p">{</span>
</span><span class='line'>     <span class="n">frame_width</span> <span class="o">=</span> <span class="mi">320</span><span class="p">,</span>
</span><span class='line'>     <span class="n">frame_height</span> <span class="o">=</span> <span class="mi">200</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="n">bool</span> <span class="nf">write_to_ppm</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span>
</span><span class='line'>                      <span class="kt">int</span> <span class="n">width</span><span class="p">,</span>
</span><span class='line'>                      <span class="kt">int</span> <span class="n">height</span><span class="p">,</span>
</span><span class='line'>                      <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">fileName</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>     <span class="kt">FILE</span> <span class="o">*</span><span class="n">fd</span> <span class="o">=</span> <span class="o">::</span><span class="n">fopen</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="s">&quot;w+&quot;</span><span class="p">);</span>
</span><span class='line'>     <span class="k">if</span> <span class="p">(</span><span class="n">fd</span><span class="p">)</span>
</span><span class='line'>     <span class="p">{</span>
</span><span class='line'>          <span class="o">::</span><span class="n">fprintf</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="s">&quot;P6</span><span class="se">\n</span><span class="s">%d, %d</span><span class="se">\n</span><span class="s">255&quot;</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">);</span>
</span><span class='line'>          <span class="o">::</span><span class="n">fwrite</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">width</span> <span class="o">*</span> <span class="n">height</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fd</span><span class="p">);</span>
</span><span class='line'>          <span class="o">::</span><span class="n">fclose</span><span class="p">(</span><span class="n">fd</span><span class="p">);</span>
</span><span class='line'>          <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
</span><span class='line'>     <span class="p">}</span>
</span><span class='line'>     <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>
</span><span class='line'>     <span class="k">typedef</span> <span class="n">agg</span><span class="o">::</span><span class="n">pixfmt_rgb24</span>          <span class="n">pixfmt_type</span><span class="p">;</span>
</span><span class='line'>     <span class="k">typedef</span> <span class="n">agg</span><span class="o">::</span><span class="n">renderer_base</span><span class="o">&lt;</span><span class="n">agg</span><span class="o">::</span><span class="n">pixfmt_rgb24</span><span class="o">&gt;</span> <span class="n">renbase_type</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>     <span class="k">enum</span> <span class="p">{</span><span class="n">bytes_per_pixel</span> <span class="o">=</span> <span class="mi">3</span><span class="p">};</span>
</span><span class='line'>
</span><span class='line'>     <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">buffer</span> <span class="o">=</span> <span class="n">new</span> <span class="kt">unsigned</span> <span class="kt">char</span><span class="p">[</span><span class="n">frame_width</span> <span class="o">*</span> <span class="n">frame_height</span> <span class="o">*</span><span class="mi">3</span><span class="p">];</span>
</span><span class='line'>     <span class="c1">//memset(buffer, 255, frame_height * frame_width * 3);</span>
</span><span class='line'>
</span><span class='line'>     <span class="n">agg</span><span class="o">::</span><span class="n">rendering_buffer</span> <span class="n">rbuf</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">frame_width</span><span class="p">,</span> <span class="n">frame_height</span><span class="p">,</span> <span class="n">frame_width</span> <span class="o">*</span> <span class="mi">3</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>     <span class="n">pixfmt_type</span> <span class="n">pixf</span><span class="p">(</span><span class="n">rbuf</span><span class="p">);</span>
</span><span class='line'>     <span class="n">renbase_type</span> <span class="n">rbase</span><span class="p">(</span><span class="n">pixf</span><span class="p">);</span>
</span><span class='line'>     <span class="n">renbase_type</span><span class="o">::</span><span class="n">color_type</span> <span class="n">clear_color</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">);</span>
</span><span class='line'>     <span class="n">rbase</span><span class="p">.</span><span class="n">clear</span><span class="p">(</span><span class="n">clear_color</span><span class="p">);</span> <span class="c1">//使用此颜色画背景色。</span>
</span><span class='line'>     <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">rbuf</span><span class="p">.</span><span class="n">height</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span><span class='line'>     <span class="p">{</span>
</span><span class='line'>          <span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="n">p</span> <span class="o">=</span> <span class="n">rbuf</span><span class="p">.</span><span class="n">row_ptr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">3</span><span class="p">;</span> <span class="c1">//rgb三个像素的跨度，所以乘以三来取</span>
</span><span class='line'>          <span class="o">*</span><span class="n">p</span><span class="o">++</span> <span class="o">=</span> <span class="mi">127</span><span class="p">;</span> <span class="c1">//R</span>
</span><span class='line'>          <span class="o">*</span><span class="n">p</span><span class="o">++</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span> <span class="c1">//G</span>
</span><span class='line'>          <span class="o">*</span><span class="n">p</span><span class="o">++</span> <span class="o">=</span> <span class="mi">98</span><span class="p">;</span> <span class="c1">//B</span>
</span><span class='line'>
</span><span class='line'>     <span class="p">}</span>
</span><span class='line'>     <span class="n">write_to_ppm</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">frame_width</span><span class="p">,</span> <span class="n">frame_height</span><span class="p">,</span> <span class="s">&quot;agg_test.ppm&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="n">delete</span> <span class="p">[]</span><span class="n">buffer</span><span class="p">;</span>
</span><span class='line'>     <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>打开此文件，效果如下。
<img src="http://i.imgur.com/5zmUntx.png"></p>

<p>rendering_buffer本身不知道内存中的像素格式的任何信息，都是通过纯手工来设置每一个自己的值。提供了一系列访问内存的方法。它只是保存了一个数组，数组的元素指向没一行的开头。申请和释放存储区是使用者的责任，你可以用任何形式来申请和释放内存。</p>
</div>
  
  


    </article>
  
  
    <article>
      


  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/04/25/agg/">Agg例子解析</a></h1>
    
    
    <p class="meta">
      








  


<time datetime="2013-04-25T07:20:00+08:00" pubdate data-updated="true">Apr 25<span>th</span>, 2013</time>
	  

<span class="tags">
  Tag:
  
    <a href='/blog/tags/agg/'>agg</a>
  
</span>

      <span class="share-to-weibo">
        <a href="javascript:void(0)" onclick="window.open('http://service.weibo.com/share/share.php?appkey=&amp;ralateUid=1954936591&amp;title=Agg例子解析 - &amp;url=http://sweetdark.github.com/blog/2013/04/25/agg/', null, 'width=615,height=505,toolbar=0,status=0')" class="sina-weibo" title="分享到新浪微博"></a>

        <a href="javascript:void(0)" onclick="window.open('http://share.v.t.qq.com/index.php?c=share&amp;a=index&amp;appkey=&amp;title=Agg例子解析 - &amp;url=http://sweetdark.github.com/blog/2013/04/25/agg/', null, 'width=700,height=680,toolbar=0,status=0')" class="tencent-weibo" title="分享到腾讯微博"></a>

        <a href="javascript:void(0)" onclick="window.open('https://twitter.com/intent/tweet?text=Agg例子解析 - http://sweetdark.github.com/blog/2013/04/25/agg/', null, 'width=600,height=300,toolbar=0,status=0')" class="twitter" title="分享到Twitter"></a>
      </span>
    </p>
  
  </header>


  <div class="entry-content"><p>aa_demo</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
<span class='line-number'>185</span>
<span class='line-number'>186</span>
<span class='line-number'>187</span>
<span class='line-number'>188</span>
<span class='line-number'>189</span>
<span class='line-number'>190</span>
<span class='line-number'>191</span>
<span class='line-number'>192</span>
<span class='line-number'>193</span>
<span class='line-number'>194</span>
<span class='line-number'>195</span>
<span class='line-number'>196</span>
<span class='line-number'>197</span>
<span class='line-number'>198</span>
<span class='line-number'>199</span>
<span class='line-number'>200</span>
<span class='line-number'>201</span>
<span class='line-number'>202</span>
<span class='line-number'>203</span>
<span class='line-number'>204</span>
<span class='line-number'>205</span>
<span class='line-number'>206</span>
<span class='line-number'>207</span>
<span class='line-number'>208</span>
<span class='line-number'>209</span>
<span class='line-number'>210</span>
<span class='line-number'>211</span>
<span class='line-number'>212</span>
<span class='line-number'>213</span>
<span class='line-number'>214</span>
<span class='line-number'>215</span>
<span class='line-number'>216</span>
<span class='line-number'>217</span>
<span class='line-number'>218</span>
<span class='line-number'>219</span>
<span class='line-number'>220</span>
<span class='line-number'>221</span>
<span class='line-number'>222</span>
<span class='line-number'>223</span>
<span class='line-number'>224</span>
<span class='line-number'>225</span>
<span class='line-number'>226</span>
<span class='line-number'>227</span>
<span class='line-number'>228</span>
<span class='line-number'>229</span>
<span class='line-number'>230</span>
<span class='line-number'>231</span>
<span class='line-number'>232</span>
<span class='line-number'>233</span>
<span class='line-number'>234</span>
<span class='line-number'>235</span>
<span class='line-number'>236</span>
<span class='line-number'>237</span>
<span class='line-number'>238</span>
<span class='line-number'>239</span>
<span class='line-number'>240</span>
<span class='line-number'>241</span>
<span class='line-number'>242</span>
<span class='line-number'>243</span>
<span class='line-number'>244</span>
<span class='line-number'>245</span>
<span class='line-number'>246</span>
<span class='line-number'>247</span>
<span class='line-number'>248</span>
<span class='line-number'>249</span>
<span class='line-number'>250</span>
<span class='line-number'>251</span>
<span class='line-number'>252</span>
<span class='line-number'>253</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="cp">#include &quot;agg_basics.h&quot;</span>
</span><span class='line'><span class="cp">#include &quot;agg_rendering_buffer.h&quot;</span>
</span><span class='line'><span class="cp">#include &quot;agg_rasterizer_scanline_aa.h&quot;</span>
</span><span class='line'><span class="cp">#include &quot;agg_renderer_scanline.h&quot;</span>
</span><span class='line'><span class="cp">#include &quot;agg_scanline_u.h&quot;</span>
</span><span class='line'><span class="cp">#include &quot;platform/agg_platform_support.h&quot;</span>
</span><span class='line'><span class="cp">#include &quot;ctrl/agg_slider_ctrl.h&quot;</span>
</span><span class='line'><span class="cp">#include &quot;ctrl/agg_cbox_ctrl.h&quot;</span>
</span><span class='line'><span class="cp">#include &quot;agg_pixfmt_rgb.h&quot;</span>
</span><span class='line'><span class="cp">#include &lt;stdlib.h&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="k">enum</span> <span class="n">flip_y_e</span> <span class="p">{</span><span class="n">flip_y</span> <span class="o">=</span> <span class="nb">true</span><span class="p">};</span>
</span><span class='line'><span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="n">namespace</span> <span class="n">agg</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="n">class</span> <span class="n">square</span>   <span class="c1">//正方形</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>  <span class="nl">public:</span>
</span><span class='line'>      <span class="n">square</span><span class="p">(</span><span class="kt">double</span> <span class="n">size</span><span class="p">)</span> <span class="o">:</span> <span class="n">m_size</span><span class="p">(</span><span class="n">size</span><span class="p">)</span> <span class="p">{}</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">template</span><span class="o">&lt;</span><span class="n">class</span> <span class="n">Rasterizer</span><span class="p">,</span> <span class="n">class</span> <span class="n">Scanline</span><span class="p">,</span> <span class="n">class</span> <span class="n">Renderer</span><span class="p">,</span> <span class="n">class</span> <span class="n">ColorT</span><span class="o">&gt;</span>
</span><span class='line'>      <span class="kt">void</span> <span class="n">draw</span><span class="p">(</span><span class="n">Rasterizer</span><span class="o">&amp;</span> <span class="n">ras</span><span class="p">,</span> <span class="n">Scanline</span><span class="o">&amp;</span> <span class="n">sl</span><span class="p">,</span> <span class="n">Renderer</span><span class="o">&amp;</span> <span class="n">ren</span><span class="p">,</span> <span class="n">ColorT</span> <span class="n">color</span><span class="p">,</span>
</span><span class='line'>          <span class="kt">double</span> <span class="n">x</span><span class="p">,</span> <span class="kt">double</span> <span class="n">y</span><span class="p">)</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>          <span class="n">ras</span><span class="p">.</span><span class="n">reset</span><span class="p">();</span>  <span class="c1">//光栅化器的重置</span>
</span><span class='line'>          <span class="c1">//画正方形的图形，只是一些列的命令还未渲染，着色</span>
</span><span class='line'>          <span class="n">ras</span><span class="p">.</span><span class="n">move_to_d</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">m_size</span><span class="p">,</span>        <span class="n">y</span><span class="o">*</span><span class="n">m_size</span><span class="p">);</span>
</span><span class='line'>          <span class="n">ras</span><span class="p">.</span><span class="n">line_to_d</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">m_size</span><span class="o">+</span><span class="n">m_size</span><span class="p">,</span> <span class="n">y</span><span class="o">*</span><span class="n">m_size</span><span class="p">);</span>
</span><span class='line'>          <span class="n">ras</span><span class="p">.</span><span class="n">line_to_d</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">m_size</span><span class="o">+</span><span class="n">m_size</span><span class="p">,</span> <span class="n">y</span><span class="o">*</span><span class="n">m_size</span><span class="o">+</span><span class="n">m_size</span><span class="p">);</span>
</span><span class='line'>          <span class="n">ras</span><span class="p">.</span><span class="n">line_to_d</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">m_size</span><span class="p">,</span>        <span class="n">y</span><span class="o">*</span><span class="n">m_size</span><span class="o">+</span><span class="n">m_size</span><span class="p">);</span>
</span><span class='line'>          <span class="c1">//渲染</span>
</span><span class='line'>          <span class="n">agg</span><span class="o">::</span><span class="n">render_scanlines_aa_solid</span><span class="p">(</span><span class="n">ras</span><span class="p">,</span> <span class="n">sl</span><span class="p">,</span> <span class="n">ren</span><span class="p">,</span> <span class="n">color</span><span class="p">);</span>
</span><span class='line'>          <span class="n">count</span><span class="o">++</span><span class="p">;</span>  <span class="c1">//计数画了多少个</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nl">private:</span>
</span><span class='line'>      <span class="kt">double</span> <span class="n">m_size</span><span class="p">;</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">//自定义的渲染器,实现固定的几个方法。</span>
</span><span class='line'>  <span class="n">template</span><span class="o">&lt;</span><span class="n">class</span> <span class="n">Renderer</span><span class="o">&gt;</span> <span class="n">class</span> <span class="n">renderer_enlarged</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>  <span class="nl">public:</span>
</span><span class='line'>      <span class="n">renderer_enlarged</span><span class="p">(</span><span class="n">Renderer</span><span class="o">&amp;</span> <span class="n">ren</span><span class="p">,</span> <span class="kt">double</span> <span class="n">size</span><span class="p">)</span> <span class="o">:</span>
</span><span class='line'>        <span class="n">m_ren</span><span class="p">(</span><span class="n">ren</span><span class="p">),</span>
</span><span class='line'>            <span class="n">m_square</span><span class="p">(</span><span class="n">size</span><span class="p">),</span>
</span><span class='line'>            <span class="n">m_size</span><span class="p">(</span><span class="n">size</span><span class="p">)</span> <span class="p">{}</span>
</span><span class='line'>        <span class="c1">//--------------------------------------------------------------------</span>
</span><span class='line'>        <span class="kt">void</span> <span class="n">color</span><span class="p">(</span><span class="n">rgba8</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span> <span class="n">m_color</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>        <span class="c1">//--------------------------------------------------------------------</span>
</span><span class='line'>        <span class="kt">void</span> <span class="n">prepare</span><span class="p">()</span> <span class="p">{}</span>
</span><span class='line'>        <span class="c1">//--------------------------------------------------------------------渲染</span>
</span><span class='line'>        <span class="n">template</span><span class="o">&lt;</span><span class="n">class</span> <span class="n">Scanline</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="n">render</span><span class="p">(</span><span class="k">const</span> <span class="n">Scanline</span><span class="o">&amp;</span> <span class="n">sl</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sl</span><span class="p">.</span><span class="n">y</span><span class="p">();</span>  <span class="c1">//y坐标</span>
</span><span class='line'>
</span><span class='line'>            <span class="kt">unsigned</span> <span class="n">num_spans</span> <span class="o">=</span> <span class="n">sl</span><span class="p">.</span><span class="n">num_spans</span><span class="p">();</span>  <span class="c1">//跨度</span>
</span><span class='line'>            <span class="kr">typename</span> <span class="n">Scanline</span><span class="o">::</span><span class="n">const_iterator</span> <span class="n">span</span> <span class="o">=</span> <span class="n">sl</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>            <span class="k">do</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">span</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">;</span>  <span class="c1">//起始的x坐标</span>
</span><span class='line'>                <span class="k">const</span> <span class="kr">typename</span> <span class="n">Scanline</span><span class="o">::</span><span class="n">cover_type</span><span class="o">*</span> <span class="n">covers</span> <span class="o">=</span> <span class="n">span</span><span class="o">-&gt;</span><span class="n">covers</span><span class="p">;</span> <span class="c1">//覆盖值</span>
</span><span class='line'>                <span class="kt">int</span> <span class="n">num_pix</span> <span class="o">=</span> <span class="n">span</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>                <span class="k">do</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'><span class="c1">//                     int a = (*covers++ * m_color.a) &gt;&gt; 8;</span>
</span><span class='line'>                  
</span><span class='line'>                    <span class="n">m_square</span><span class="p">.</span><span class="n">draw</span><span class="p">(</span><span class="n">m_ras</span><span class="p">,</span> <span class="n">m_sl</span><span class="p">,</span> <span class="n">m_ren</span><span class="p">,</span>
</span><span class='line'>                        <span class="n">rgba8</span><span class="p">(</span><span class="n">m_color</span><span class="p">.</span><span class="n">r</span><span class="p">,</span> <span class="n">m_color</span><span class="p">.</span><span class="n">g</span><span class="p">,</span> <span class="n">m_color</span><span class="p">.</span><span class="n">b</span><span class="p">,</span> <span class="n">m_color</span><span class="p">.</span><span class="n">a</span><span class="p">),</span>
</span><span class='line'>                        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>  <span class="c1">//画一个正方形</span>
</span><span class='line'>                    <span class="o">++</span><span class="n">x</span><span class="p">;</span> <span class="c1">//画下一个正方形</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>                <span class="k">while</span><span class="p">(</span><span class="o">--</span><span class="n">num_pix</span><span class="p">);</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>            <span class="k">while</span><span class="p">(</span><span class="o">--</span><span class="n">num_spans</span><span class="p">);</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nl">private:</span>
</span><span class='line'>      <span class="n">rasterizer_scanline_aa</span><span class="o">&lt;&gt;</span> <span class="n">m_ras</span><span class="p">;</span>
</span><span class='line'>      <span class="c1">//容器 ,在光栅化器rasterizer_scanline_aa和渲染器scanline_render之间多了一个容器。负责信息的转换。</span>
</span><span class='line'>      <span class="c1">//由很多水平不想交的span组成。这些span按x排序。</span>
</span><span class='line'>      <span class="n">scanline_u8</span> <span class="n">m_sl</span><span class="p">;</span>
</span><span class='line'>      <span class="n">Renderer</span><span class="o">&amp;</span>   <span class="n">m_ren</span><span class="p">;</span>
</span><span class='line'>      <span class="n">square</span>      <span class="n">m_square</span><span class="p">;</span>
</span><span class='line'>      <span class="n">rgba8</span>       <span class="n">m_color</span><span class="p">;</span>
</span><span class='line'>      <span class="kt">double</span>      <span class="n">m_size</span><span class="p">;</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="n">class</span> <span class="n">the_application</span> <span class="o">:</span> <span class="n">public</span> <span class="n">agg</span><span class="o">::</span><span class="n">platform_support</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="kt">double</span> <span class="n">m_x</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
</span><span class='line'>  <span class="kt">double</span> <span class="n">m_y</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
</span><span class='line'>  <span class="kt">double</span> <span class="n">m_dx</span><span class="p">;</span>
</span><span class='line'>  <span class="kt">double</span> <span class="n">m_dy</span><span class="p">;</span>
</span><span class='line'>  <span class="kt">int</span>    <span class="n">m_idx</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">agg</span><span class="o">::</span><span class="n">slider_ctrl</span><span class="o">&lt;</span><span class="n">agg</span><span class="o">::</span><span class="n">rgba8</span><span class="o">&gt;</span> <span class="n">m_slider1</span><span class="p">;</span>
</span><span class='line'>  <span class="n">agg</span><span class="o">::</span><span class="n">slider_ctrl</span><span class="o">&lt;</span><span class="n">agg</span><span class="o">::</span><span class="n">rgba8</span><span class="o">&gt;</span> <span class="n">m_slider2</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nl">public:</span>
</span><span class='line'>  <span class="n">the_application</span><span class="p">(</span><span class="n">agg</span><span class="o">::</span><span class="n">pix_format_e</span> <span class="n">format</span><span class="p">,</span> <span class="n">bool</span> <span class="n">flip_y</span><span class="p">)</span> <span class="o">:</span>
</span><span class='line'>    <span class="n">agg</span><span class="o">::</span><span class="n">platform_support</span><span class="p">(</span><span class="n">format</span><span class="p">,</span> <span class="n">flip_y</span><span class="p">),</span>
</span><span class='line'>  <span class="n">m_slider1</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">600</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="o">!</span><span class="n">flip_y</span><span class="p">),</span>
</span><span class='line'>  <span class="n">m_slider2</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">10</span><span class="o">+</span><span class="mi">20</span><span class="p">,</span> <span class="mi">600</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="o">+</span><span class="mi">20</span><span class="p">,</span> <span class="o">!</span><span class="n">flip_y</span><span class="p">)</span>
</span><span class='line'>   <span class="p">{</span>
</span><span class='line'>      <span class="n">m_idx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span><span class='line'>      <span class="n">m_x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">57</span><span class="p">;</span> <span class="n">m_y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
</span><span class='line'>      <span class="n">m_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">369</span><span class="p">;</span>    <span class="n">m_y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">170</span><span class="p">;</span>
</span><span class='line'>      <span class="n">m_x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">143</span><span class="p">;</span>    <span class="n">m_y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">310</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">add_ctrl</span><span class="p">(</span><span class="n">m_slider1</span><span class="p">);</span>
</span><span class='line'>      <span class="n">add_ctrl</span><span class="p">(</span><span class="n">m_slider2</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">m_slider1</span><span class="p">.</span><span class="n">range</span><span class="p">(</span><span class="mf">8.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">);</span>
</span><span class='line'>      <span class="n">m_slider1</span><span class="p">.</span><span class="n">num_steps</span><span class="p">(</span><span class="mi">23</span><span class="p">);</span>
</span><span class='line'>      <span class="n">m_slider1</span><span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="mf">32.0</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">m_slider2</span><span class="p">.</span><span class="n">range</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">);</span>
</span><span class='line'>      <span class="n">m_slider2</span><span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="mf">1.0</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">m_slider1</span><span class="p">.</span><span class="n">label</span><span class="p">(</span><span class="s">&quot;Pixel size = %1.0f&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="n">m_slider2</span><span class="p">.</span><span class="n">label</span><span class="p">(</span><span class="s">&quot;Gamma = %4.3f&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">m_slider1</span><span class="p">.</span><span class="n">no_transform</span><span class="p">();</span>
</span><span class='line'>      <span class="n">m_slider1</span><span class="p">.</span><span class="n">no_transform</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>   <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="k">virtual</span> <span class="o">~</span><span class="n">the_application</span><span class="p">()</span> <span class="p">{}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">virtual</span> <span class="kt">void</span> <span class="n">on_init</span><span class="p">()</span> <span class="p">{}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">virtual</span> <span class="kt">void</span> <span class="n">on_draw</span><span class="p">()</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>      <span class="k">typedef</span> <span class="n">agg</span><span class="o">::</span><span class="n">renderer_base</span><span class="o">&lt;</span><span class="n">agg</span><span class="o">::</span><span class="n">pixfmt_bgr24</span><span class="o">&gt;</span> <span class="n">ren_base</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">agg</span><span class="o">::</span><span class="n">pixfmt_bgr24</span> <span class="n">pixf</span><span class="p">(</span><span class="n">rbuf_window</span><span class="p">());</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">ren_base</span> <span class="n">ren</span><span class="p">(</span><span class="n">pixf</span><span class="p">);</span>  <span class="c1">//基础渲染器</span>
</span><span class='line'>      <span class="n">agg</span><span class="o">::</span><span class="n">scanline_u8</span> <span class="n">sl</span><span class="p">;</span>  <span class="c1">//扫描线容器</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">ren</span><span class="p">.</span><span class="n">clear</span><span class="p">(</span><span class="n">agg</span><span class="o">::</span><span class="n">rgba</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span> <span class="c1">//设置背景色</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">agg</span><span class="o">::</span><span class="n">rasterizer_scanline_aa</span><span class="o">&lt;&gt;</span> <span class="n">ras</span><span class="p">;</span> <span class="c1">//光栅化类</span>
</span><span class='line'>
</span><span class='line'>      <span class="kt">int</span> <span class="n">size_mul</span> <span class="o">=</span> <span class="kt">int</span><span class="p">(</span><span class="n">m_slider1</span><span class="p">.</span><span class="n">value</span><span class="p">());</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">ras</span><span class="p">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">agg</span><span class="o">::</span><span class="n">gamma_power</span><span class="p">(</span><span class="n">m_slider2</span><span class="p">.</span><span class="n">value</span><span class="p">()));</span>  <span class="c1">//设置gamma值</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">agg</span><span class="o">::</span><span class="n">renderer_enlarged</span><span class="o">&lt;</span><span class="n">ren_base</span><span class="o">&gt;</span> <span class="n">ren_en</span><span class="p">(</span><span class="n">ren</span><span class="p">,</span> <span class="n">size_mul</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">ras</span><span class="p">.</span><span class="n">reset</span><span class="p">();</span>
</span><span class='line'>      <span class="c1">//画一个大的三角形的范围，然后再用正方形填充</span>
</span><span class='line'>      <span class="n">ras</span><span class="p">.</span><span class="n">move_to_d</span><span class="p">(</span><span class="n">m_x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">size_mul</span><span class="p">,</span> <span class="n">m_y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">size_mul</span><span class="p">);</span> <span class="c1">//从左下角为坐标开始</span>
</span><span class='line'>      <span class="n">ras</span><span class="p">.</span><span class="n">line_to_d</span><span class="p">(</span><span class="n">m_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">size_mul</span><span class="p">,</span> <span class="n">m_y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">size_mul</span><span class="p">);</span>
</span><span class='line'>      <span class="n">ras</span><span class="p">.</span><span class="n">line_to_d</span><span class="p">(</span><span class="n">m_x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">size_mul</span><span class="p">,</span> <span class="n">m_y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">size_mul</span><span class="p">);</span>
</span><span class='line'>      <span class="c1">//设置渲染器，渲染的颜色，用渲染指令替顶点源着色</span>
</span><span class='line'>      <span class="n">ren_en</span><span class="p">.</span><span class="n">color</span><span class="p">(</span><span class="n">agg</span><span class="o">::</span><span class="n">rgba8</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">));</span>
</span><span class='line'>      <span class="n">agg</span><span class="o">::</span><span class="n">render_scanlines</span><span class="p">(</span><span class="n">ras</span><span class="p">,</span> <span class="n">sl</span><span class="p">,</span> <span class="n">ren_en</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="kt">char</span> <span class="n">tst</span><span class="p">[</span><span class="mi">255</span><span class="p">];</span>
</span><span class='line'>      <span class="o">::</span><span class="n">itoa</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">tst</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
</span><span class='line'>      <span class="n">m_slider1</span><span class="p">.</span><span class="n">label</span><span class="p">(</span><span class="n">tst</span><span class="p">);</span>
</span><span class='line'>      <span class="n">agg</span><span class="o">::</span><span class="n">render_ctrl</span><span class="p">(</span><span class="n">ras</span><span class="p">,</span> <span class="n">sl</span><span class="p">,</span> <span class="n">ren</span><span class="p">,</span> <span class="n">m_slider1</span><span class="p">);</span>
</span><span class='line'>      <span class="n">agg</span><span class="o">::</span><span class="n">render_ctrl</span><span class="p">(</span><span class="n">ras</span><span class="p">,</span> <span class="n">sl</span><span class="p">,</span> <span class="n">ren</span><span class="p">,</span> <span class="n">m_slider2</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">virtual</span> <span class="kt">void</span> <span class="n">on_mouse_button_down</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">flags</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span><span class="p">(</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">agg</span><span class="o">::</span><span class="n">mouse_left</span><span class="p">)</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>          <span class="kt">unsigned</span> <span class="n">i</span><span class="p">;</span>
</span><span class='line'>          <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span><span class='line'>          <span class="p">{</span>
</span><span class='line'>              <span class="k">if</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">m_x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">m_x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">m_y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">m_y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="mf">10.0</span><span class="p">)</span>
</span><span class='line'>              <span class="p">{</span>
</span><span class='line'>                  <span class="n">m_dx</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">m_x</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span><span class='line'>                  <span class="n">m_dy</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">m_y</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span><span class='line'>                  <span class="n">m_idx</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span><span class='line'>                  <span class="k">break</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span>
</span><span class='line'>          <span class="p">{</span>
</span><span class='line'>              <span class="k">if</span><span class="p">(</span><span class="n">agg</span><span class="o">::</span><span class="n">point_in_triangle</span><span class="p">(</span><span class="n">m_x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">m_y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span class='line'>                  <span class="n">m_x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">m_y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
</span><span class='line'>                  <span class="n">m_x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">m_y</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
</span><span class='line'>                  <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</span><span class='line'>              <span class="p">{</span>
</span><span class='line'>                  <span class="n">m_dx</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">m_x</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
</span><span class='line'>                  <span class="n">m_dy</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">m_y</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
</span><span class='line'>                  <span class="n">m_idx</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="k">virtual</span> <span class="kt">void</span> <span class="n">on_mouse_move</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">flags</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span><span class="p">(</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">agg</span><span class="o">::</span><span class="n">mouse_left</span><span class="p">)</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>          <span class="k">if</span><span class="p">(</span><span class="n">m_idx</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span>
</span><span class='line'>          <span class="p">{</span>
</span><span class='line'>              <span class="kt">double</span> <span class="n">dx</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">m_dx</span><span class="p">;</span>
</span><span class='line'>              <span class="kt">double</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">m_dy</span><span class="p">;</span>
</span><span class='line'>              <span class="n">m_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">m_x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">dx</span><span class="p">;</span>
</span><span class='line'>              <span class="n">m_y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">m_y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">dy</span><span class="p">;</span>
</span><span class='line'>              <span class="n">m_x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-=</span> <span class="n">m_x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">dx</span><span class="p">;</span>
</span><span class='line'>              <span class="n">m_y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-=</span> <span class="n">m_y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">dy</span><span class="p">;</span>
</span><span class='line'>              <span class="n">m_x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">dx</span><span class="p">;</span>
</span><span class='line'>              <span class="n">m_y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">dy</span><span class="p">;</span>
</span><span class='line'>              <span class="n">force_redraw</span><span class="p">();</span>
</span><span class='line'>              <span class="k">return</span><span class="p">;</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">if</span><span class="p">(</span><span class="n">m_idx</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>          <span class="p">{</span>
</span><span class='line'>              <span class="n">m_x</span><span class="p">[</span><span class="n">m_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">m_dx</span><span class="p">;</span>
</span><span class='line'>              <span class="n">m_y</span><span class="p">[</span><span class="n">m_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">m_dy</span><span class="p">;</span>
</span><span class='line'>              <span class="n">force_redraw</span><span class="p">();</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">else</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>          <span class="n">on_mouse_button_up</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">virtual</span> <span class="kt">void</span> <span class="n">on_mouse_button_up</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">flags</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="n">m_idx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="kt">int</span> <span class="nf">agg_main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="n">the_application</span> <span class="n">app</span><span class="p">(</span><span class="n">agg</span><span class="o">::</span><span class="n">pix_format_bgr24</span><span class="p">,</span> <span class="n">flip_y</span><span class="p">);</span>
</span><span class='line'>  <span class="n">app</span><span class="p">.</span><span class="n">caption</span><span class="p">(</span><span class="s">&quot;My first Example&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">app</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="n">agg</span><span class="o">::</span><span class="n">window_resize</span><span class="p">))</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="n">app</span><span class="p">.</span><span class="n">run</span><span class="p">();</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>效果图
<a href="http://imgur.com/eC5sCqa" title=""><img src="http://i.imgur.com/eC5sCqa.jpg" title="Hosted by imgur.com" alt="" /></a>
流程图
<a href="http://imgur.com/sHAd1Nu" title=""><img src="http://i.imgur.com/sHAd1Nu.jpg" title="Hosted by imgur.com" alt="" /></a></p>
</div>
  
  


    </article>
  
  
    <article>
      


  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/04/07/refrect/">晨写</a></h1>
    
    
    <p class="meta">
      








  


<time datetime="2013-04-07T21:00:00+08:00" pubdate data-updated="true">Apr 7<span>th</span>, 2013</time>
	  

<span class="tags">
  Tag:
  
    <a href='/blog/tags/thinking/'>Thinking</a>
  
</span>

      <span class="share-to-weibo">
        <a href="javascript:void(0)" onclick="window.open('http://service.weibo.com/share/share.php?appkey=&amp;ralateUid=1954936591&amp;title=晨写 - &amp;url=http://sweetdark.github.com/blog/2013/04/07/refrect/', null, 'width=615,height=505,toolbar=0,status=0')" class="sina-weibo" title="分享到新浪微博"></a>

        <a href="javascript:void(0)" onclick="window.open('http://share.v.t.qq.com/index.php?c=share&amp;a=index&amp;appkey=&amp;title=晨写 - &amp;url=http://sweetdark.github.com/blog/2013/04/07/refrect/', null, 'width=700,height=680,toolbar=0,status=0')" class="tencent-weibo" title="分享到腾讯微博"></a>

        <a href="javascript:void(0)" onclick="window.open('https://twitter.com/intent/tweet?text=晨写 - http://sweetdark.github.com/blog/2013/04/07/refrect/', null, 'width=600,height=300,toolbar=0,status=0')" class="twitter" title="分享到Twitter"></a>
      </span>
    </p>
  
  </header>


  <div class="entry-content"><p>因为手受伤了，一直没有进行晨写。昨天晚上突发奇想，要继续晨写事业。于是昨晚跑到文具店，去买了一本活页的笔记本，准备今天早上就开始晨写。有很多方法可以记录想法，其中一些效率更高。最好的方法之一就是晨写。是作家惯用的技术。
规则如下：</p>

<p>1.晨写是早晨要做的第一件事————一起来就开始写。
2.至少写三页，手写。
3.不要审查删减你写的东西。不论优秀的还是陈腐的，只管写下来。
4.坚持天天写。</p>

<p>晨写让毫无防备的大脑倾倒想法。早上刚起床时，你还有没有那么清醒，潜意识仍然占主角。你可以直接连通R型思维。</p>

<p>今天早上起来写了两页。昨天晚上一时兴起，裸睡了。早上起来时候，也没穿裤子就披了一个外套就开始写，写了约半个小时，奋笔疾书啊，字潦草的不得了。写了整整两页纸，写到手痛。晨写+晨间日记+易筋经 早上需要花一个小时。</p>

<p>摘抄一点写的内容。</p>

<blockquote><p>虽然感觉自己是在乱写，想到什么就写什么。但乱写是我的本能。就让我的笔尖在纸面上快速的游走，直到擦出智慧的火花来。思绪就像流水一般涌出，源源不断。墨水在笔尖淌出，沾染了淡黄色的直面，形成一个个跳跃的文字，或美或丑，但放荡不羁。</p></blockquote>


<p><img src="http://b271.photo.store.qq.com/psb?/V132KGkX169tds/YbPWwPPGfHkTN6NvVt9dLxudyepeyCosDhY43u0wXCY!/b/dGKMkKFJCQAA&bo=3wEgAwAAAAABANo!"></p>

<p><img src="http://b274.photo.store.qq.com/psb?/V132KGkX169tds/K7mR*kr6hudyH4llw3M33KZ1LOhEgZ.9TtmZ7KTksKs!/b/dLjgW6O8BwAA&bo=3wEgAwAAAAABANo!"></p>
</div>
  
  


    </article>
  
  
    <article>
      


  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/03/15/new-post/">随想</a></h1>
    
    
    <p class="meta">
      








  


<time datetime="2013-03-15T20:52:00+08:00" pubdate data-updated="true">Mar 15<span>th</span>, 2013</time>
	  

<span class="tags">
  Tag:
  
    <a href='/blog/tags/thinking/'>Thinking</a>
  
</span>

      <span class="share-to-weibo">
        <a href="javascript:void(0)" onclick="window.open('http://service.weibo.com/share/share.php?appkey=&amp;ralateUid=1954936591&amp;title=随想 - &amp;url=http://sweetdark.github.com/blog/2013/03/15/new-post/', null, 'width=615,height=505,toolbar=0,status=0')" class="sina-weibo" title="分享到新浪微博"></a>

        <a href="javascript:void(0)" onclick="window.open('http://share.v.t.qq.com/index.php?c=share&amp;a=index&amp;appkey=&amp;title=随想 - &amp;url=http://sweetdark.github.com/blog/2013/03/15/new-post/', null, 'width=700,height=680,toolbar=0,status=0')" class="tencent-weibo" title="分享到腾讯微博"></a>

        <a href="javascript:void(0)" onclick="window.open('https://twitter.com/intent/tweet?text=随想 - http://sweetdark.github.com/blog/2013/03/15/new-post/', null, 'width=600,height=300,toolbar=0,status=0')" class="twitter" title="分享到Twitter"></a>
      </span>
    </p>
  
  </header>


  <div class="entry-content"><p>手恢复之后的第一篇博客。短短的一个月，感觉发了好多好多事情。坠入爱河，在爱河中沉醉。特别是这个星期，人有点魂不守舍的，对工作的影响还是蛮大的。第一次体验到这么深的爱，迷失了自我。还没调整好自己的心态，在工作的时候也会胡思乱想。这个星期一直在摸索和思考，如何去分配好自己的时间在工作和爱情上。我会很用心的去经营这段感情，爱你时一定要专心爱你，全身心的投入爱你。但我希望工作时也一样能够全身心的投入工作。当然不是你的问题，是我自己还没调整好罢了，需要摸索一段时间。</p>

<p>最近迷失在微博和知乎上，一直不停的刷。其实根本没这个必要，隔很长一段时间再去刷一下就好了。因为我的微博和知乎都关注的特别少，短时间内怎么刷都是那样。为了让自己戒了这个瘾下个星期就不上微博了。把上微博的时间用来学习和做重要的事情。知乎我也要控制一下，一天就中午和晚上刷一下就好。工作时间还是别上的好。最近时间被碎片化的很厉害。又有了微信和啪啪。所以要好好的管理一下自己的时间了。</p>

<p><embed src="http://www.xiami.com/widget/3946428_10671967_235_346_FF8719_494949_0/shufflePlayer.swf" type="application/x-shockwave-flash" width="235" height="346" wmode="opaque"></embed></p>
</div>
  
  


    </article>
  
  
    <article>
      


  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/03/06/new/">体验当下</a></h1>
    
    
    <p class="meta">
      








  


<time datetime="2013-03-06T22:42:00+08:00" pubdate data-updated="true">Mar 6<span>th</span>, 2013</time>
	  

<span class="tags">
  Tag:
  
    <a href='/blog/tags/live/'>Live</a>
  
</span>

      <span class="share-to-weibo">
        <a href="javascript:void(0)" onclick="window.open('http://service.weibo.com/share/share.php?appkey=&amp;ralateUid=1954936591&amp;title=体验当下 - &amp;url=http://sweetdark.github.com/blog/2013/03/06/new/', null, 'width=615,height=505,toolbar=0,status=0')" class="sina-weibo" title="分享到新浪微博"></a>

        <a href="javascript:void(0)" onclick="window.open('http://share.v.t.qq.com/index.php?c=share&amp;a=index&amp;appkey=&amp;title=体验当下 - &amp;url=http://sweetdark.github.com/blog/2013/03/06/new/', null, 'width=700,height=680,toolbar=0,status=0')" class="tencent-weibo" title="分享到腾讯微博"></a>

        <a href="javascript:void(0)" onclick="window.open('https://twitter.com/intent/tweet?text=体验当下 - http://sweetdark.github.com/blog/2013/03/06/new/', null, 'width=600,height=300,toolbar=0,status=0')" class="twitter" title="分享到Twitter"></a>
      </span>
    </p>
  
  </header>


  <div class="entry-content"><p>我们把概念看的比事实重要。而概念是死的，事实是活的。一颗心如果充满着各种各样的概念，你的心就变死了。尊重事实，别被概念所蒙骗，别被教条所束缚。要有把概念和教条当成玩物的勇气。</p>

<p>我们脑海中有许许多多关于爱的概念，喜欢在他人身上套用，这无可厚非。但事实总是在变化着的。如果你死脑筋的执著那个概念，会给你带来痛苦。何不好好体验当下爱的感觉，而不是被你脑海中的概念所摆布。</p>

<p>当你在追求快乐的时候，说明你现在快乐。当你达到目的时候，你快乐了一阵子，就过去了，你开始懊恼为什么快乐总是消失的那么快。于是又去追寻下一个快乐，你又变得不快乐了。不要说我现在不快乐。有了房有了车就会快乐了。你当下就可以快乐，为什么还要等到有房有车呢。当下你就能获得快乐，如果不能一定是心出了问题。</p>

<p>过去的已经过去，未来真的存在吗。我不知道。未来只不过是自我的延伸和投射，你的想象，我执。当下才是最真实最重要，也可以是最美好的。你的心能安住于当下，也就减少了烦恼。你才能客观全面的看待事物，才能发现美。你的心像翻滚的江河，你无法倒影天空的美，无法倒影河边上的鲜花。心如止水，专注的做好当下的事，发现当下的美。有了方向要一步一步认真专心的走，过程比目的更重要。</p>

<p>专注于当下你可以把握事物瞬间的变化。我们的总认为某些事物是恒常的。当有一天书变黄了，你就心生苦恼书怎么突然就变黄了。当有一天，你照着镜子发现自己变老了，你又开始苦恼，怎么突然老了好多，其实你每一刻都在变老，只是你没有注意到罢了。</p>
</div>
  
  


    </article>
  
  
    <article>
      


  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/02/28/ding/">定</a></h1>
    
    
    <p class="meta">
      








  


<time datetime="2013-02-28T21:27:00+08:00" pubdate data-updated="true">Feb 28<span>th</span>, 2013</time>
	  

<span class="tags">
  Tag:
  
    <a href='/blog/tags/zen/'>Zen</a>
  
</span>

      <span class="share-to-weibo">
        <a href="javascript:void(0)" onclick="window.open('http://service.weibo.com/share/share.php?appkey=&amp;ralateUid=1954936591&amp;title=定 - &amp;url=http://sweetdark.github.com/blog/2013/02/28/ding/', null, 'width=615,height=505,toolbar=0,status=0')" class="sina-weibo" title="分享到新浪微博"></a>

        <a href="javascript:void(0)" onclick="window.open('http://share.v.t.qq.com/index.php?c=share&amp;a=index&amp;appkey=&amp;title=定 - &amp;url=http://sweetdark.github.com/blog/2013/02/28/ding/', null, 'width=700,height=680,toolbar=0,status=0')" class="tencent-weibo" title="分享到腾讯微博"></a>

        <a href="javascript:void(0)" onclick="window.open('https://twitter.com/intent/tweet?text=定 - http://sweetdark.github.com/blog/2013/02/28/ding/', null, 'width=600,height=300,toolbar=0,status=0')" class="twitter" title="分享到Twitter"></a>
      </span>
    </p>
  
  </header>


  <div class="entry-content"><p>人的思绪总是漂浮在两种状态中，一是散乱，二是昏沉。普通人就在散乱和昏沉中度过一生，连一秒钟的定都达不到。因为平常极少反省，又少观察，故不能自知。散乱的思想像河流一样，一分一秒不停地在流。如何将念头止住唯一的方法就是修定。修定有许许多多的法门，其实就是一个方法“一念之间”。一念之间有八万四千烦恼，甚至更多。如何将这一念定住，使八万四千烦恼停止。</p>

<p>任何的思想，任何的情绪，中间都有空隙，可以用“观心”的方法发现这个空隙。能够找到心中心波起伏的空隙，则念头可以转变，较容易获得清明安定。如果把一空隙的时间延长再延长，而停留再在这种状态，则心境变得安定宁静。既无啊悲哀也无忧伤，安详平静。净土宗的念佛，禅宗的打坐，天台宗的打坐，都是在求定都是要把连续的念头打断，集中于一，以达到一心不乱的境界。定的法门很多，没有一个法门适用于任何人，要找到适合自己的法门。至于练气，练瑜伽，观呼吸，听声音，也都是一种方法。</p>
</div>
  
  


    </article>
  
  
    <article>
      


  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/02/26/impo/">重要的事</a></h1>
    
    
    <p class="meta">
      








  


<time datetime="2013-02-26T10:12:00+08:00" pubdate data-updated="true">Feb 26<span>th</span>, 2013</time>
	  

<span class="tags">
  Tag:
  
    <a href='/blog/tags/live/'>Live</a>
  
</span>

      <span class="share-to-weibo">
        <a href="javascript:void(0)" onclick="window.open('http://service.weibo.com/share/share.php?appkey=&amp;ralateUid=1954936591&amp;title=重要的事 - &amp;url=http://sweetdark.github.com/blog/2013/02/26/impo/', null, 'width=615,height=505,toolbar=0,status=0')" class="sina-weibo" title="分享到新浪微博"></a>

        <a href="javascript:void(0)" onclick="window.open('http://share.v.t.qq.com/index.php?c=share&amp;a=index&amp;appkey=&amp;title=重要的事 - &amp;url=http://sweetdark.github.com/blog/2013/02/26/impo/', null, 'width=700,height=680,toolbar=0,status=0')" class="tencent-weibo" title="分享到腾讯微博"></a>

        <a href="javascript:void(0)" onclick="window.open('https://twitter.com/intent/tweet?text=重要的事 - http://sweetdark.github.com/blog/2013/02/26/impo/', null, 'width=600,height=300,toolbar=0,status=0')" class="twitter" title="分享到Twitter"></a>
      </span>
    </p>
  
  </header>


  <div class="entry-content"><p><a href="http://imgur.com/yndq6Hp"><img src="http://i.imgur.com/yndq6Hp.jpg?1" alt="" title="Hosted by imgur.com" /></a></p>
</div>
  
  


    </article>
  
  
    <article>
      


  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/02/17/newday/">2-17日记</a></h1>
    
    
    <p class="meta">
      








  


<time datetime="2013-02-17T21:41:00+08:00" pubdate data-updated="true">Feb 17<span>th</span>, 2013</time>
	  

<span class="tags">
  Tag:
  
    <a href='/blog/tags/live/'>Live</a>
  
</span>

      <span class="share-to-weibo">
        <a href="javascript:void(0)" onclick="window.open('http://service.weibo.com/share/share.php?appkey=&amp;ralateUid=1954936591&amp;title=2-17日记 - &amp;url=http://sweetdark.github.com/blog/2013/02/17/newday/', null, 'width=615,height=505,toolbar=0,status=0')" class="sina-weibo" title="分享到新浪微博"></a>

        <a href="javascript:void(0)" onclick="window.open('http://share.v.t.qq.com/index.php?c=share&amp;a=index&amp;appkey=&amp;title=2-17日记 - &amp;url=http://sweetdark.github.com/blog/2013/02/17/newday/', null, 'width=700,height=680,toolbar=0,status=0')" class="tencent-weibo" title="分享到腾讯微博"></a>

        <a href="javascript:void(0)" onclick="window.open('https://twitter.com/intent/tweet?text=2-17日记 - http://sweetdark.github.com/blog/2013/02/17/newday/', null, 'width=600,height=300,toolbar=0,status=0')" class="twitter" title="分享到Twitter"></a>
      </span>
    </p>
  
  </header>


  <div class="entry-content"><p>今天6点多就醒来了，还是很困，有蚊子一直在耳边“嗡嗡嗡”，睡不着了。起来闭眼静坐了一会。然后穿上衣服，开始晨写，想到啥就写，不要去评判和思考。晨写的目的是为了锻炼R型思维，锻炼自己的直觉。按照书本上的是要写三页的，但显然我没那么多充裕的时间，就花了15分钟，不停的写。虽然写的乱七八糟，但感觉还是蛮爽的，好像在山谷里大喊，把所有心声释放出去一样。</p>

<p>春节在家期间，有很多事，好久没有进行禅修了。今天刻意提醒自己，放慢做事情的速度，练正念。提前点出门，以较慢的速度走去公司。这个过程，不去思考任何事情和东西，仅仅是感觉脚踩在地上的感觉，那种力从脚掌传上来。有眼睛去看周围的世界，飘落的树叶，路边的花，呼啸而过的公交车，女孩脸上的笑。</p>

<p>生活中，我们总是忘记了去细心感受。</p>
</div>
  
  


    </article>
  
  
    <article>
      


  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/02/05/article/">随笔</a></h1>
    
    
    <p class="meta">
      








  


<time datetime="2013-02-05T18:47:00+08:00" pubdate data-updated="true">Feb 5<span>th</span>, 2013</time>
	  

<span class="tags">
  Tag:
  
    <a href='/blog/tags/live/'>Live</a>
  
</span>

      <span class="share-to-weibo">
        <a href="javascript:void(0)" onclick="window.open('http://service.weibo.com/share/share.php?appkey=&amp;ralateUid=1954936591&amp;title=随笔 - &amp;url=http://sweetdark.github.com/blog/2013/02/05/article/', null, 'width=615,height=505,toolbar=0,status=0')" class="sina-weibo" title="分享到新浪微博"></a>

        <a href="javascript:void(0)" onclick="window.open('http://share.v.t.qq.com/index.php?c=share&amp;a=index&amp;appkey=&amp;title=随笔 - &amp;url=http://sweetdark.github.com/blog/2013/02/05/article/', null, 'width=700,height=680,toolbar=0,status=0')" class="tencent-weibo" title="分享到腾讯微博"></a>

        <a href="javascript:void(0)" onclick="window.open('https://twitter.com/intent/tweet?text=随笔 - http://sweetdark.github.com/blog/2013/02/05/article/', null, 'width=600,height=300,toolbar=0,status=0')" class="twitter" title="分享到Twitter"></a>
      </span>
    </p>
  
  </header>


  <div class="entry-content"><p>思念似水，</p>

<p>流入我的心房。</p>

<p>拧开心房的阀门，</p>

<p>用晶莹的玻璃瓶承装，愿永久存放。</p>

<p>想念的是你，你在我心中。我愿写成文字，用博客承载思念。</p>

<blockquote><p>你未看此花时，此花与汝心同归于寂；你来看此花时，此花颜色一时明白起来，便知此花不在你的心外。</p><footer><strong>王明阳</strong> <cite></cite></footer></blockquote>

</div>
  
  


    </article>
  
  
    <article>
      


  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/01/27/meet/">聚会</a></h1>
    
    
    <p class="meta">
      








  


<time datetime="2013-01-27T21:31:00+08:00" pubdate data-updated="true">Jan 27<span>th</span>, 2013</time>
	  

<span class="tags">
  Tag:
  
    <a href='/blog/tags/live/'>Live</a>
  
</span>

      <span class="share-to-weibo">
        <a href="javascript:void(0)" onclick="window.open('http://service.weibo.com/share/share.php?appkey=&amp;ralateUid=1954936591&amp;title=聚会 - &amp;url=http://sweetdark.github.com/blog/2013/01/27/meet/', null, 'width=615,height=505,toolbar=0,status=0')" class="sina-weibo" title="分享到新浪微博"></a>

        <a href="javascript:void(0)" onclick="window.open('http://share.v.t.qq.com/index.php?c=share&amp;a=index&amp;appkey=&amp;title=聚会 - &amp;url=http://sweetdark.github.com/blog/2013/01/27/meet/', null, 'width=700,height=680,toolbar=0,status=0')" class="tencent-weibo" title="分享到腾讯微博"></a>

        <a href="javascript:void(0)" onclick="window.open('https://twitter.com/intent/tweet?text=聚会 - http://sweetdark.github.com/blog/2013/01/27/meet/', null, 'width=600,height=300,toolbar=0,status=0')" class="twitter" title="分享到Twitter"></a>
      </span>
    </p>
  
  </header>


  <div class="entry-content"><p>今天约了经文和海哥去看电影《007：大破天幕杀机》，很好看的一部电影，刺激。看完电影去茶楼吃饭。边吃边聊，聊的都是工作上的事情。都在抱怨自己工作上的不如意，公司抠门什么之类的。听他们两这么说，我也变得悲观起来了。生活不就是如此吗，不如意的事十有八九，其实很多IT公司都这样，换了未必就会更好。就这么谈论着，我忘记了刚才才享受了美妙的电影。直到我搭上公交时，才意识到自己刚才挺消沉的。不想让自己继续消沉下去，慢慢的调整自己的心态。生活还是充满着乐趣的，要善于去发现和感受。以后要是在遇到这类谈话，自己应该多多鼓励别人才是，而不是顺着他们消沉下去，对大家的影响都不好。</p>

<p>我很知足了，家庭幸福平安，又有一堆朋友，他们都是善良的人，对我也很好。只要好好地去工作，好好的去爱一个人，好好地生活就很幸福。</p>

<p>谢谢海哥买了电影票，经文请吃饭。下次轮到自己请客了。<strong>一起加油吧</strong></p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>最新发布</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/04/28/agg/">agg渲染内存</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/25/agg/">agg例子解析</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/07/refrect/">晨写</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/03/15/new-post/">随想</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/03/06/new/">体验当下</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/sweetdark">@sweetdark</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'sweetdark',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>

<section>
  <h1>Tag Cloud</h1>
    <span id="tag-cloud"><embed type='application/x-shockwave-flash' src='/javascripts/tagcloud.swf'width='100%' height='250' bgcolor='#f2f2f2' id='tagcloudflash' name='tagcloudflash' quality='high' allowscriptaccess='always'flashvars="tcolor=0x333333&amp;tcolor2=0x333333&amp;hicolor=0x000000&amp;tspeed=100&amp;distr=true&amp;mode=tags&amp;tagcloud=%3Ctags%3E%3Ca+href%3D%27http%3A%2F%2Fsweetdark.github.com%2Fblog%2Ftags%2Fagg%27+style%3D%27font-size%3A+18.88888888888889%25%27%3Eagg%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2Fsweetdark.github.com%2Fblog%2Ftags%2Falgorithm%27+style%3D%27font-size%3A+14.444444444444445%25%27%3Ealgorithm%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2Fsweetdark.github.com%2Fblog%2Ftags%2Fdebug%27+style%3D%27font-size%3A+14.444444444444445%25%27%3Edebug%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2Fsweetdark.github.com%2Fblog%2Ftags%2Fgithub%27+style%3D%27font-size%3A+23.333333333333336%25%27%3EGithub%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2Fsweetdark.github.com%2Fblog%2Ftags%2Flive%27+style%3D%27font-size%3A+50.0%25%27%3ELive%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2Fsweetdark.github.com%2Fblog%2Ftags%2Fmarkdown%27+style%3D%27font-size%3A+14.444444444444445%25%27%3Emarkdown%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2Fsweetdark.github.com%2Fblog%2Ftags%2Fmethod%27+style%3D%27font-size%3A+14.444444444444445%25%27%3Emethod%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2Fsweetdark.github.com%2Fblog%2Ftags%2Foctopress%27+style%3D%27font-size%3A+23.333333333333336%25%27%3Eoctopress%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2Fsweetdark.github.com%2Fblog%2Ftags%2Fthinking%27+style%3D%27font-size%3A+36.66666666666667%25%27%3EThinking%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2Fsweetdark.github.com%2Fblog%2Ftags%2Fzen%27+style%3D%27font-size%3A+18.88888888888889%25%27%3Ezen%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2Fsweetdark.github.com%2Fblog%2Ftags%2Fzen%27+style%3D%27font-size%3A+14.444444444444445%25%27%3EZen%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2Fsweetdark.github.com%2Fblog%2Ftags%2Fsuan-fa-yu-shu-ju-jie-gou%27+style%3D%27font-size%3A+14.444444444444445%25%27%3E%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%3C%2Fa%3E+%3Ca+href%3D%27http%3A%2F%2Fsweetdark.github.com%2Fblog%2Ftags%2Fsui-bi%27+style%3D%27font-size%3A+14.444444444444445%25%27%3E%E9%9A%8F%E7%AC%94%3C%2Fa%3E+%3C%2Ftags%3E"></span>
</section>

<section>
<iframe id="sina_widget_1954936591" style="width:100%; height:500px;" frameborder="0" scrolling="no" src="http://v.t.sina.com.cn/widget/widget_blog.php?uid=1954936591&height=500&skin=wd_02&showpic=1"></iframe>
</section><section>
<embed src="http://www.xiami.com/widget/3946428_71613,71970,387331,70748,70767,70769,70749,71598,71131,70764,70758,70946,71309,_235_346_FF8719_494949_0/multiPlayer.swf" type="application/x-shockwave-flash" width="250" height="346" wmode="opaque">
</section>


  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Mario -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'sweetdark';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
